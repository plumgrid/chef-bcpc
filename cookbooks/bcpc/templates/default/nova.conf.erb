################################################
#
#              Generated by Chef
#
################################################

[DEFAULT]

# MySQL Connection
sql_connection=mysql://<%="#{get_config('mysql-nova-user')}"%>:<%="#{get_config('mysql-nova-password')}"%>@<%="#{node[:bcpc][:management][:vip]}"%>/<%="#{node['bcpc']['nova_dbname']}"%>

# Rabbit message queue settings
rabbit_host=<%="#{node[:bcpc][:management][:vip]}"%>
rabbit_password=<%="#{get_config('rabbitmq-password')}"%>
rabbit_ha_queues=False
rabbit_durable_queues=True

# If using qpid...
#rpc_backend=nova.openstack.common.rpc.impl_qpid
#qpid_hostname=<%="#{node[:bcpc][:management][:vip]}"%>
#qpid_username=admin
#qpid_password=<%="#{get_config('rabbitmq-password')}"%>

rpc_backend=nova.openstack.common.rpc.impl_kombu

# Nova API settings
auth_strategy=keystone
api_paste_config=/etc/nova/api-paste.ini
s3_host=<%="#{node[:bcpc][:management][:vip]}"%>
ec2_listen=<%="#{node[:bcpc][:management][:ip]}"%>
ec2_host=<%="#{node[:bcpc][:management][:ip]}"%>
osapi_compute_listen=<%="#{node[:bcpc][:management][:ip]}"%>
metadata_listen=<%="#{node[:bcpc][:management][:ip]}"%>
metadata_host=<%="#{node[:bcpc][:management][:ip]}"%>
dmz_cidr=169.254.169.254/32
enabled_apis=ec2,osapi_compute,metadata

# Nova Scheduler
scheduler_driver=nova.scheduler.filter_scheduler.FilterScheduler

# Nova Compute settings
connection_type=libvirt
libvirt_type=<%="#{node[:bcpc][:virt_type]}"%>
libvirt_use_virtio_for_bridges=True
use_cow_images=True
#snapshot_image_format=qcow2
#start_guests_on_host_boot=True
#resume_guests_state_on_host_boot=True
live_migration_retry_count=30
live_migration_uri=qemu+tcp://%s/system
live_migration_bandwidth=0

# Nova Volume settings
volume_api_class=nova.volume.cinder.API

# This flag is added by the patch from Inktank
always_use_volumes=True

# Nova VNC settings
vnc_enabled=True
novncproxy_base_url=http://<%="#{node[:bcpc][:management][:ip]}"%>:6080/vnc_auto.html
vncserver_proxyclient_address=127.0.0.1
novncproxy_host=<%="#{node[:bcpc][:management][:ip]}"%>
memcached_servers=<%="#{node[:bcpc][:management][:vip]}"%>:11211

# Glance settings
image_service=nova.image.glance.GlanceImageService
glance_api_servers=<%="#{node[:bcpc][:management][:vip]}"%>:9292

# Cloudpipe
vpn_image_id=<%="#{get_config('glance-cloudpipe-uuid')}"%>
use_project_ca=True
cnt_vpn_clients=5

# Misc other settings
logdir=/var/log/nova
state_path=/var/lib/nova
lock_path=/var/lib/nova
rootwrap_config=/etc/nova/rootwrap.conf
verbose=True
debug=False
ec2_private_dns_show_ip=True
#default_log_levels="amqplib=DEBUG,sqlalchemy=DEBUG,boto=WARN,suds=INFO,eventlet.wsgi.server=WARN"
#rpc_response_timeout=120

# Quantum
firewall_driver = <%="#{node[:bcpc][:quantum][:firewall_driver]}"%>
compute_driver = <%="#{node[:bcpc][:quantum][:compute_driver]}"%>
service_quantum_metadata_proxy = <%="#{node[:bcpc][:quantum][:metadata_proxy]}"%>
linuxnet_interface_driver =
libvirt_vif_driver = <%="#{node[:bcpc][:quantum][:libvirt_vif_driver]}"%>
security_group_api = <%="#{node[:bcpc][:quantum][:security_group_api]}"%>
quantum_url = http://<%="#{node[:bcpc][:management][:vip]}"%>:<%="#{node[:bcpc][:quantum][:bind_port]}"%>
quantum_admin_tenant_name = <%="#{node[:bcpc][:admin_tenant]}"%>
quantum_auth_strategy = <%="#{node[:bcpc][:quantum][:auth_strategy]}"%>
quantum_admin_auth_url = http://<%="#{node[:bcpc][:management][:vip]}"%>:35357/v2.0
quantum_admin_password = <%="#{get_config('keystone-admin-password')}"%>
quantum_admin_username = <%="#{get_config('keystone-admin-user')}"%>
network_api_class = <%="#{node[:bcpc][:quantum][:network_api_class]}"%>

instances_path = /mnt/var/lib/nova/instances
instance_name_template = instance-%08x

# Auto-generated per-node settings below
